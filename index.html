<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Lembar Kerja Limit \(x \to 0\)</title>
  <style>
    body {
      font-family: Verdana, sans-serif;
      background-color: #fff8f0;
      color: #333;
      padding: 20px;
      margin: 0;
    }

    h1 {
      background-color: #ff9f43;
      color: white;
      padding: 15px;
      border-radius: 15px;
      text-align: center;
    }

    button {
      background-color: #ffa726;
      color: white;
      border: none;
      padding: 10px 20px;
      font-size: 16px;
      border-radius: 10px;
      cursor: pointer;
      margin-top: 10px;
      margin-right: 10px;
    }

    label, input {
      font-size: 16px;
    }

    .soal {
      background-color: #ffe0b2;
      border-radius: 10px;
      padding: 15px;
      margin: 10px 0;
      text-align: left;
      page-break-inside: avoid;
    }

    textarea {
      width: 100%;
      min-height: 80px;
      border-radius: 8px;
      border: 1.5px solid #ffa726;
      padding: 10px;
      font-family: Verdana, sans-serif;
      font-size: 14px;
      resize: vertical;
      margin-top: 5px;
      box-sizing: border-box;
    }

    #hasil {
      margin-top: 20px;
      padding: 20px;
      background-color: #dcedc8;
      border-radius: 15px;
      font-size: 16px;
      text-align: left;
    }

    #hasil h3 {
      color: #33691e;
    }

    #hasil li {
      margin-bottom: 15px;
      background: #f0f4c3;
      padding: 10px 15px;
      border-radius: 10px;
      line-height: 1.6;
    }

    #hasil strong {
      display: block;
      margin-top: 20px;
      font-size: 18px;
    }

    .math-pembahasan {
      background-color: #fffde7;
      padding: 10px;
      border-radius: 10px;
      font-family: Verdana, sans-serif;
    }

    @media print {
      button, input {
        display: none;
      }
      #hasil {
        page-break-before: always;
      }
    }

    @media (max-width: 600px) {
      body {
        padding: 10px;
      }
      button {
        width: 100%;
        margin-right: 0;
        margin-bottom: 10px;
      }
    }
  </style>

  <!-- MathJax -->
  <script>
    window.MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        processEscapes: true
      },
      svg: {
        fontCache: 'global',
        scale: 1.4  // Memperbesar tampilan rumus matematika
      }
    };
  </script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" async></script>
</head>
<body>
  <h1>Lembar Kerja Limit \(x \to 0\)</h1>

  <label>Jumlah Soal: <input type="number" id="jumlah" value="5" min="1" max="20" /></label>
  <br>
  <button onclick="generateSoal()">Buat Soal</button>
  <button onclick="window.print()">Cetak</button>
  <button onclick="tampilkanJawaban()">Tampilkan Kunci Jawaban</button>
  <button onclick="location.reload()">Mulai Ulang</button>

  <div id="daftar-soal"></div>
  <div id="hasil"></div>

  <script>
    const bentukSoal = [
      k => `Hitung $\\lim_{x \\to 0} \\frac{\\sin(${k === 1 ? '' : k}x)}{x}$.`,
      k => `Tentukan nilai $\\lim_{x \\to 0} \\frac{\\tan(${k === 1 ? '' : k}x)}{x}$.`,
      k => `Hitung $\\lim_{x \\to 0} \\frac{1 - \\cos(${k === 1 ? '' : k}x)}{x^2}$.`,
      k => `Hitung $\\lim_{x \\to 0} \\frac{e^{${k === 1 ? '' : k}x} - 1}{x}$.`,
      k => `Tentukan nilai $\\lim_{x \\to 0} \\frac{\\ln(1 + ${k === 1 ? '' : k}x)}{x}$.`
    ];

    const pembahasan = [
      k => `Gunakan $\\lim_{x \\to 0} \\frac{\\sin x}{x} = 1$. Maka, $\\frac{\\sin(${k}x)}{x} = ${k} \\cdot \\frac{\\sin(${k}x)}{${k}x} = ${k}$.`,
      k => `Gunakan $\\lim_{x \\to 0} \\frac{\\tan x}{x} = 1$. Maka, $\\frac{\\tan(${k}x)}{x} = ${k} \\cdot \\frac{\\tan(${k}x)}{${k}x} = ${k}$.`,
      k => `Gunakan $\\lim_{x \\to 0} \\frac{1 - \\cos x}{x^2} = \\frac{1}{2}$. Maka, $\\frac{1 - \\cos(${k}x)}{x^2} = ${k}^2 \\cdot \\frac{1 - \\cos(${k}x)}{(${k}x)^2} = ${(k*k)/2}$.`,
      k => `Gunakan $\\lim_{x \\to 0} \\frac{e^x - 1}{x} = 1$. Maka, $\\frac{e^{${k}x} - 1}{x} = ${k}$.`,
      k => `Gunakan $\\lim_{x \\to 0} \\frac{\\ln(1+x)}{x} = 1$. Maka, $\\frac{\\ln(1 + ${k}x)}{x} = ${k}$.`
    ];

    let soalData = [];

    function getRandomKoef() {
      const koef = [1, 2, 3, 4, 5];
      return koef[Math.floor(Math.random() * koef.length)];
    }

    function generateSoal() {
      const jumlah = parseInt(document.getElementById("jumlah").value);
      const wadah = document.getElementById("daftar-soal");
      wadah.innerHTML = "";
      soalData = [];

      const dipakai = new Set();

      for (let i = 0; i < jumlah; i++) {
        let idx, k, kode, percobaan = 0;
        do {
          idx = Math.floor(Math.random() * bentukSoal.length);
          k = getRandomKoef();
          kode = `${idx}-${k}`;
          percobaan++;
        } while (dipakai.has(kode) && percobaan < 20);
        dipakai.add(kode);

        soalData.push({ idx, k });
        wadah.innerHTML += `
          <div class="soal">
            <strong>Soal ${i + 1}:</strong><br>
            ${bentukSoal[idx](k)}<br>
            <textarea></textarea>
          </div>`;
      }

      MathJax.typesetPromise();
    }

    function tampilkanJawaban() {
      const hasil = document.getElementById("hasil");
      let html = "<h3>Hasil dan Pembahasan:</h3><ol>";

      soalData.forEach((s, i) => {
        html += `<li>${bentukSoal[s.idx](s.k)}<div class="math-pembahasan">${pembahasan[s.idx](s.k)}</div></li>`;
      });

      html += "</ol>";
      hasil.innerHTML = html;
      MathJax.typesetPromise();
    }
  </script>
</body>
</html>
